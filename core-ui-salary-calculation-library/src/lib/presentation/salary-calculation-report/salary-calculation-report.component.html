<nav aria-label="breadcrumb" class="d-flex align-items-center justify-content-between my-3 height-2">
    <p-breadcrumb
        id="salaryReportbreadcrumbNavigation"
        tabindex="-1"
        class="max-w-full fw-medium"
        [model]="items"
        [home]="home">
    </p-breadcrumb>
</nav>

<section class="mx-0 shadow-none">
    <div class="d-flex gap-3">
        <lib-salary-report-filters
            id="salaryReportFilters"
            (filtersApplied)="onFiltersApplied($event)"
            (filterPanelState)="filterPanelToggler($event)">
        </lib-salary-report-filters>

        <div class="card vh-140 rounded-6 border-0 w-100">
            <div class="d-flex align-items-center py-14 px-24 border-bottom-2 border-gray-300 min-h-px-70 max-h-px-70">
                <div class="min-w-18">
                    <h1 class="mb-0 fs-16 fw-semibold color-gray-1000">
                        Salary Report
                    </h1>
                </div>
            </div>
<!-- - We export data between the date range even pending manual salary lines are there, but we show a warning to user that there are pending manual salary lines and they wont be part of the exported data.
 -->
          <div class="mb-3" *ngIf="hasPendingReports()">
            <lib-warning-banner
              [show]="hasPendingReports()"
              title="Pending Salary Lines"
              message="There are pending salary lines that won't be included in the exported data.">
            </lib-warning-banner>
          </div>

        <salary-calculation-portal-progress-loading loaderKey="SalaryReport_CalculateReport"></salary-calculation-portal-progress-loading>

            <!-- <div
                class="d-flex gap-3 align-items-baseline justify-content-between bg-danger-100 px-20 py-2 border-start-3 border-danger-400 mb-3"
                *ngIf="showWarning && warningMessage"
                id="sarlayReportwarningBanner"
                @fadeInOut>
                <div class="d-flex gap-3 align-items-baseline">
                    <div>
                        <i class="fa fa-exclamation-circle color-danger-500"></i>
                    </div>
                    <div>
                        <div class="mb-px-4">
                            <h6 class="fs-14 color-gray-1000 mb-0 align-items-center">
                                Warning
                            </h6>
                        </div>
                        <p class="fs-14 color-gray-700 mb-1">
                            {{ warningMessage }}
                        </p>
                    </div>
                </div>
            </div> -->
            <div class="py-16 overflow-auto vh-277" *ngIf="filtersApplied">

               <div class="px-2 pb-3">
                @for(item of salaryReports$.slice(0, 2); track item) {
                  <div class="d-flex">
                    <div class="min-w-px-200 px-3 py-12">
                      <h2 class="mb-0 color-gray-800 fw-medium fs-15">{{item.label || '-'}}</h2>
                    </div>

                    <div class="px-3 py-12 min-w-px-154 text-center">
                      <h2 class="mb-0 color-gray-800 fw-medium fs-15">{{item.total ?? 0}}</h2>
                    </div>
                  </div>
                }
               </div>
                <div class="p-table-header-white w-xxl-100 pt-2 border-top border-gray-300">
                  <div class="px-2">
                    <p-table
                      id="salarySummaryTable"
                      [value]="salaryReports$.slice(2)"
                      class="text-center"
                    >
                      <ng-template pTemplate="header">
                        <tr>
                          <th class="width-px-200 min-w-px-120"></th>
                          <th class="width-px-154">Total</th>
                          <th class="width-px-154">
                            <span 
                              tooltipPosition="top"
                              class="cursor-pointer"
                              tooltipStyleClass="p-tooltip-fs-11 customized-tooltip"
                              pTooltip="Salary lines are linked to a job that has not yet been completed.">
                              
                              <!-- info-circle -->
                              <i class="fa-solid fa-circle-info me-1 pt-px-3 fs-16 text-info"></i>
                              Pending
                            </span>
                          </th>
                          <th>Pending Approval</th>
                          <th>Approved</th>
                          <th>Rejected</th>
                        </tr>
                      </ng-template>

                      <ng-template pTemplate="body" let-row>
                        <tr>
                          <td class="text-start fw-medium">
                            {{ row?.label || '-' }}
                          </td>
                          <td class="text-center fw-medium">
                            <span>{{ row?.total ?? 0 }}</span>
                          </td>
                          <td class="text-center fw-medium">
                            <span>{{ row?.approvedUnprocessed ?? 0 }}</span>
                          </td>
                          <td class="text-center fw-medium">
                            <span>{{ row?.pending ?? 0 }}</span>
                          </td>
                          <td class="text-center fw-medium">
                            <span [ngClass]="{'color-success-500': row?.approved > 0}">{{ row?.approved ?? 0 }}</span>
                          </td>
                          <td class="text-center fw-medium">
                            <span [ngClass]="{'color-danger-500': row?.rejected > 0}">{{ row?.rejected ?? 0 }}</span>
                          </td>
                        </tr>
                      </ng-template>

                    </p-table>
                  </div>
                </div>
            </div>

            <div class="card border-0 h-100 shadow-md" *ngIf="!filtersApplied">
              <div class="empty-state">
                  <div class="illustration bg-white">
                      <svg class="height-12 width-12">
                          <use xlink:href="#empty-state"></use>
                      </svg>
                  </div>
                  <p class="bg-white fs-18 p-0 fw-medium color-gray-700">
                    Apply filters to load the records.
                  </p>
              </div>
            </div>

            <div class="card-footer justify-content-end border-top-0" *ngIf="filtersApplied">
              <div>
                <button
                  (click)="navigateToExportReports()"
                  id="report-cancel-btn"
                  class="btn btn-sm btn-outline-secondary px-30 me-2">
                  Cancel
                </button>

                <button
                  (click)="exportReports()"
                  id="report-export-btn"
                  type="button"
                  class="btn btn-sm btn-primary px-30">
                  Export Reports
                </button>
              </div>
            </div>

        </div>
    </div>
</section>
