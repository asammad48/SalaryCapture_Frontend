What i need to to do is simply add 
import { Injectable } from '@angular/core';
import { InteractionRequiredAuthError } from "@azure/msal-browser";
import { MsalService } from '@azure/msal-angular';
import { firstValueFrom } from 'rxjs';
 
@Injectable({
  providedIn: 'root',
})
export class AuthService {
  constructor(private readonly msalService: MsalService) {
    console.log('AuthService initialized');
  }
 
  async getAccessToken(apiScope: string): Promise<string | null> {
    let activeAccount = this.msalService.instance.getActiveAccount();
    if (
      !activeAccount &&
      this.msalService.instance.getAllAccounts().length > 0
    ) {
      let accounts = this.msalService.instance.getAllAccounts();
      this.msalService.instance.setActiveAccount(accounts[0]);
      activeAccount = accounts[0];
    }
    if (activeAccount) {
      try {
        const response = await firstValueFrom(
          this.msalService.acquireTokenSilent({
            account: activeAccount,
            scopes: [apiScope],
          })
        );
        return response.accessToken;
      } catch (error) {
        console.error('Token acquisition failed', error);
          if (error instanceof InteractionRequiredAuthError) {
            this.msalService.logoutRedirect();
            localStorage.clear();
            sessionStorage.clear();
        }
        return null;
      }
    }
    return null;
  }
 
  logout() {
    this.msalService.logoutRedirect();
  }
}

import { HttpErrorResponse, HttpInterceptorFn } from '@angular/common/http';
import { inject } from '@angular/core';
import { catchError, from, switchMap } from 'rxjs';
import { AuthService } from '../../../accounts/auth.service';
const apiScopes: Map<string, string> = new Map<string, string>([
  [
    'https://localhost:7052',
    'api://cubivue-api-to-api-test-001/.default',
  ],
  [
    'https://app-cubivuesaasmicroservicesareamanagement-test-001.azurewebsites.net',
    'api://cubivue-api-to-api-test-001/.default',
  ],
  [
    'https://app-cubivuesaasmicroservicesareamanagement-qa-001.azurewebsites.net',
    'api://cubivue-api-to-api-test-001/.default',
  ]
]);
export const tokenInterceptor: HttpInterceptorFn = (req, next) => {
  const authService = inject(AuthService);
  const apiScope = [...apiScopes.entries()].find(
    ([url]: [string, string]) => req.url.startsWith(url)
  )?.[1];
  if (!apiScope) {
    return next(req); // No matching scope, proceed without token
  }
  return from(authService.getAccessToken(apiScope)).pipe(
    switchMap((token) => {
      const clonedReq = token
        ? req.clone({
            setHeaders: {
              Authorization: `Bearer ${token}`,
            },
          })
        : req;
      return next(clonedReq).pipe(
        catchError((error: HttpErrorResponse) => {
          if (error.status === 401) {
            console.log('Token expired');
            authService.logout();
          }
          throw error;
        })
      );
    })
  );
};

import { Environment } from '@embrace-it/area-management-lib';
 
export const environment: Environment = {
  production: false,
  NX_BASE_AM_URL:
    'https://app-cubivuesaasmicroservicesareamanagement-qa-001.azurewebsites.net/',
  NX_CLIENTID: '99f54d54-ce51-46c9-8f30-4efd9ea250f4',
  NX_AUTHORITY: 'https://cubivueidentity.ciamlogin.com/',
  NX_SCOPES: [
    'openid',
    'profile',
    'api://cubivue-api-to-api-test-001/.default',
  ],
  NX_REDIRECT_URL: 'https://areamanagement-qa.cubivue.com/',
};


 
